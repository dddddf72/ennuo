<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
      var Right = obj
        .filter(function (el) {
          return (
            el.cellX >= X + W * 0.5 &&
            ((el.cellY >= Y && el.cellY <= Y + H) ||
              (el.cellY <= Y && el.cellY + el.height >= Y))
          )
        })
        .sort(function (a, b) {
          return (
            a.cellX - b.cellX ||
            (a.cellY + a.height * 0.5 + b.cellY + b.height * 0.5 - 2 * Y - H) *
              (a.cellY + a.height * 0.5 - b.cellY - b.height * 0.5) ||
            a.cellY - b.cellY
          )
        })[0]

        /*  */
      var Bottom = obj
        .filter(function (el) {
          return (
            el.cellY >= Y + H * 0.5 &&
            ((el.cellX >= X && el.cellX <= X + W) ||
              (el.cellX <= X && el.cellX + el.width >= X))
          )
        })
        .sort(function (a, b) {
          return (
            a.cellY - b.cellY ||
            (a.cellX + a.width * 0.5 + b.cellX + b.width * 0.5 - 2 * X - W) *
              (a.cellX + a.width * 0.5 - b.cellX - b.width * 0.5) ||
            a.cellX - b.cellX
          )
        })[0]
        /*  */
      var Left = obj
        .filter(function (el) {
          return (
            el.cellX + el.width <= X + W * 0.5 &&
            ((el.cellY >= Y && el.cellY <= Y + H) ||
              (el.cellY <= Y && el.cellY + el.height >= Y))
          )
        })
        .sort(function (a, b) {
          return (
            b.cellX + b.width - a.cellX - a.width ||
            (a.cellY + a.height * 0.5 + b.cellY + b.height * 0.5 - 2 * Y - H) *
              (a.cellY + a.height * 0.5 - b.cellY - b.height * 0.5) ||
            a.cellY - b.cellY
          )
        })[0]
        /*  */
      var Top = obj
        .filter(function (el) {
          return (
            el.cellY + el.height <= Y + H * 0.5 &&
            ((el.cellX >= X && el.cellX <= X + W) ||
              (el.cellX <= X && el.cellX + el.width >= X))
          )
        })
        .sort(function (a, b) {
          return (
            b.cellY + b.height - a.cellY - a.height ||
            (a.cellX + a.width * 0.5 + b.cellX + b.width * 0.5 - 2 * X - W) *
              (a.cellX + a.width * 0.5 - b.cellX - b.width * 0.5) ||
            a.cellX - b.cellX
          )
        })[0]
    </script>
  </body>
</html>
